---
title: "Final Paper"
author: "Liz Gorrill"
date: "11/28/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```





```{r}


MA <- map_data("state", "Massachusetts")

COC <- read.csv("MA_Cleanup_Data.csv", stringsAsFactors = TRUE)

ggplot()+geom_polygon(data = MA, aes(x=long, y=lat, group = group), fill = "grey", alpha = 0.6) +
    geom_point(data = COC, aes(x=long, y = lat, size = Weight_lbs, color = Weight_lbs)) + coord_map() + xlab("Longitude") + ylab("Latitude") 
  


 


```

```{r}

COC2 <- COC %>%
  arrange(Weight_lbs) %>%
  mutate(name=factor(Town, unique(Town))) %>%
  mutate(mytext = paste(
    "Town: ", name, "\n",
    "Pounds of Trash Removed: ", Weight_lbs, sep = ""))
  

coc_map <- COC2 %>%
  ggplot() + geom_polygon(data = MA, aes(x = long, y = lat, group = group), fill = "grey", alpha = 0.6) +
  geom_point(aes(x=long, y = lat, size = Weight_lbs, color = Weight_lbs, text = mytext, alpha = 2)) +
  scale_size_continuous(range = c(1,10)) +
  theme_void() +
  coord_map() + 
  labs(title = "Connecting our Coastlines", subtitle = "Surfrider Foundation Massachusetts Chapter beach cleanup data ", color = "Weight (pounds)")
 


coc_map <- ggplotly(coc_map, tooltip = "text")

coc_map

api_create(coc_map, filename = "COC_Locations")


```

```{r}

COC_long <- COC%>%
  pivot_longer(cols = c(starts_with("Cig"), starts_with("Plastic"), starts_with("Foam"), starts_with("Ball"), starts_with("Fish"), starts_with("Hyg"), starts_with("Paper"), starts_with("Treated"), starts_with("Wood"), starts_with("Metal"), starts_with("Glass"),  starts_with("Tire"), starts_with("Fire"), starts_with("Tarp"),  starts_with("Shot")),
               names_to = "Trash_Type", values_to = "Trash_Amount") 

ggplot(COC_long, aes(x = Trash_Type, y = Trash_Amount)) + 
    geom_segment( aes(x=Trash_Type, xend=Trash_Type, y=0, yend=Trash_Amount), color="skyblue") +
  geom_point( color="blue", size=4, alpha=0.6) +
  theme_light() +
  coord_flip() +
  theme(
    panel.grid.major.y = element_blank(),
    panel.border = element_blank(),
    axis.ticks.y = element_blank()
  )

###sort data by type, create bar chart of total trash
```



```{r}
   
  
COC_Sum <-   aggregate(COC_long$Trash_Amount, by=list(Trash_Type=COC_long$Trash_Type), FUN=sum, na.rm = TRUE)

coc_bc <- plot_ly(COC_Sum, x = ~Trash_Type, y = ~x, type = "bar", name = "Trash Type Distribution") %>%
    layout(title = 'Beach Trash Totals 2021', xaxis = list(title = 'Trash Type'), 
         yaxis = list(title = 'Trash Amount (# of Individual Pieces)'))
coc_bc


```

```{r}

mytext <- COC_Sum%>% arrange(x) %>%
  mutate(name=factor(Trash_Type, unique(Trash_Type))) %>%
  mutate(mytext = paste(
    "Trash Type: ", name, "\n",
    "Amount of Trash: ", x, sep = ""))  


coc_cbc <- ggplot(COC_Sum, aes(x = Trash_Type, y = x)) +
  geom_bar(stat = "identity", fill = alpha(0.3), aes(color = Trash_Type))+
  ylim(-50, 5,000) +
   theme_minimal() +
  theme(
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.margin = unit(rep(-1,4), "cm")) +
  coord_polar(start = 0) +
  geom_text(data=COC_Sum, aes(x=Trash_Type, y=x+10, label=Trash_Type), color="black", fontface="bold",alpha=0.6, size=2.5,  inherit.aes = FALSE ) 


coc_cbc

```


```{r}

ggplot(COC_Sum, aes(x = Trash_Type, y = x)) + 
    geom_segment( aes(x=Trash_Type, xend=Trash_Type, y=0, yend=x), color="skyblue") +
  geom_point( color="blue", size=4, alpha=0.6) +
  theme_light() +
  coord_flip() +
  theme(
    panel.grid.major.y = element_blank(),
    panel.border = element_blank(),
    axis.ticks.y = element_blank()
  ) +
  xlab("Trash Type") + ylab("Amount (Individual Pieces)")


```