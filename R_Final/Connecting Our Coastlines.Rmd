---
title: "Final Paper"
author: "Liz Gorrill"
date: "11/28/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


# Abstract

The Surfrider Foundation, Massachusetts Chapter is a non-profit organization that "is dedicated to the protection and enjoyment of the world's ocean, waves and beaches, for all people, through a powerful activist network" (Surfrider Foundation, 2021). Each year beach cleanups serve as the primary form of volunteer work and the events provide a space to collect data through citizen science as well as discuss the impacts of the trash which is collected. The coronavirus (COVID-19) pandemic posed an obstacle to beach cleanups in 2021 with gatherings being against local regulations until June 2021 and volunteer comfort with gatherings being hindered through the entirety of 2021. In order to continue making progress on beach cleanups and citizen science data collection of beach trash, the Connecting Our Coastline (COC) do-it-yourself (DIY) beach cleanup initiative was introduced with the goal of at least one beach cleanup in each coastal community of Massachusetts. This paper serves as an assessment of the year long effort of COC and the implications of the results that were found through the data collected at each DIY beach cleanup.

# Introduction

In an effort to maintain volunteer involvement and continue the commitment to keeping Massachusetts beaches clean, the Surfrider Foundation, Massachusetts Chapter executive committee created DIY beach cleanup materials in November 2020 to encourage chapter volunteers and residents of coastal communities to get outside and 

# Methods

In November 2020, the executive commitee of the Surfrider Foundation, Massachusetts Chapter, put together materials including data collection cards, beach cleanup tips and disclaimers in the DIY page of the chapters website in order to provide people with a social disctancing option for keeping Massachusetts beaches clean. To gain involvement in the DIY cleanups, an initiative was held in December 2020 where people who signed up, completed a DIY beach cleanup and returned their data cards were rewarded with a gift from the chapter. This successful initiative, was then followed by a period of limited chapter related beach cleanups from January 2021 through March 2021 due to increased restrictions surrounding the COVID-19 pandemic in Massachusetts as well as restrictions put in place by Surfrider Foundation, National.

The Connecting our Coastlines initiative began in April 2021, with the initiative being announced during the monthly chapter meeting on April 7, 2021. Along with the announcement


```{r}


MA <- map_data("state", "Massachusetts")

COC <- read.csv("MA_Cleanup_Data.csv", stringsAsFactors = TRUE)

ggplot()+geom_polygon(data = MA, aes(x=long, y=lat, group = group), fill = "grey", alpha = 0.6) +
    geom_point(data = COC, aes(x=long, y = lat, size = Weight_lbs, color = Weight_lbs)) + coord_map() + xlab("Longitude") + ylab("Latitude") 
  


 


```

```{r}

COC2 <- COC %>%
  arrange(Weight_lbs) %>%
  mutate(name=factor(Town, unique(Town))) %>%
  mutate(mytext = paste(
    "Town: ", name, "\n",
    "Pounds of Trash Removed: ", Weight_lbs, sep = ""))
  

coc_map <- COC2 %>%
  ggplot() + geom_polygon(data = MA, aes(x = long, y = lat, group = group), fill = "grey", alpha = 0.6) +
  geom_point(aes(x=long, y = lat, size = Weight_lbs, color = Weight_lbs, text = mytext, alpha = 2)) +
  scale_size_continuous(range = c(1,10)) +
  theme_void() +
  coord_map() + 
  labs(title = "Connecting our Coastlines", subtitle = "Surfrider Foundation Massachusetts Chapter beach cleanup data ", color = "Weight (pounds)")
 


coc_map <- ggplotly(coc_map, tooltip = "text")

coc_map

api_create(coc_map, filename = "COC_Locations")


```

```{r}

COC_long <- COC%>%
  pivot_longer(cols = c(starts_with("Cig"), starts_with("Plastic"), starts_with("Foam"), starts_with("Ball"), starts_with("Fish"), starts_with("Hyg"), starts_with("Paper"), starts_with("Treated"), starts_with("Wood"), starts_with("Metal"), starts_with("Glass"),  starts_with("Tire"), starts_with("Fire"), starts_with("Tarp"),  starts_with("Shot")),
               names_to = "Trash_Type", values_to = "Trash_Amount") 

ggplot(COC_long, aes(x = Trash_Type, y = Trash_Amount)) + 
    geom_segment( aes(x=Trash_Type, xend=Trash_Type, y=0, yend=Trash_Amount), color="skyblue") +
  geom_point( color="blue", size=4, alpha=0.6) +
  theme_light() +
  coord_flip() +
  theme(
    panel.grid.major.y = element_blank(),
    panel.border = element_blank(),
    axis.ticks.y = element_blank()
  )

###sort data by type, create bar chart of total trash
```



```{r}
   
  
COC_Sum <-   aggregate(COC_long$Trash_Amount, by=list(Trash_Type=COC_long$Trash_Type), FUN=sum, na.rm = TRUE)

coc_bc <- plot_ly(COC_Sum, x = ~Trash_Type, y = ~x, type = "bar", name = "Trash Type Distribution") %>%
    layout(title = 'Beach Trash Totals 2021', xaxis = list(title = 'Trash Type'), 
         yaxis = list(title = 'Trash Amount (# of Individual Pieces)'))
coc_bc

api_create(coc_bc, filename = "COC_Trash_Totals")

```

```{r}

mytext <- COC_Sum%>% arrange(x) %>%
  mutate(name=factor(Trash_Type, unique(Trash_Type))) %>%
  mutate(mytext = paste(
    "Trash Type: ", name, "\n",
    "Amount of Trash: ", x, sep = ""))  


coc_cbc <- ggplot(COC_Sum, aes(x = Trash_Type, y = x)) +
  geom_bar(stat = "identity", fill = alpha(0.3), aes(color = Trash_Type))+
  ylim(-50, 5,000) +
   theme_minimal() +
  theme(
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.margin = unit(rep(-1,4), "cm")) +
  coord_polar(start = 0) +
  geom_text(data=COC_Sum, aes(x=Trash_Type, y=x+10, label=Trash_Type), color="black", fontface="bold",alpha=0.6, size=2.5,  inherit.aes = FALSE ) 


coc_cbc

```


```{r}

ggplot(COC_Sum, aes(x = Trash_Type, y = x)) + 
    geom_segment( aes(x=Trash_Type, xend=Trash_Type, y=0, yend=x), color="skyblue") +
  geom_point( color="blue", size=4, alpha=0.6) +
  theme_light() +
  coord_flip() +
  theme(
    panel.grid.major.y = element_blank(),
    panel.border = element_blank(),
    axis.ticks.y = element_blank()
  ) +
  xlab("Trash Type") + ylab("Amount (Individual Pieces)")


```