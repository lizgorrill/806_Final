---
title: "Final Paper"
author: "Liz Gorrill"
date: "11/28/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```





```{r}


MA <- map_data("state", "Massachusetts")

COC <- read.csv("MA_Cleanup_Data.csv", stringsAsFactors = TRUE)

ggplot()+geom_polygon(data = MA, aes(x=long, y=lat, group = group), fill = "grey", alpha = 0.6) +
    geom_point(data = COC, aes(x=long, y = lat, size = Weight_lbs, color = Weight_lbs)) + coord_map() 
  


 


```

```{r}

COC2 <- COC %>%
  arrange(Weight_lbs) %>%
  mutate(name=factor(Town, unique(Town))) %>%
  mutate(mytext = paste(
    "Town: ", name, "\n",
    "Pounds of Trash Removed: ", Weight_lbs, sep = ""))
  

coc_map <- COC2 %>%
  ggplot() + geom_polygon(data = MA, aes(x = long, y = lat, group = group), fill = "grey", alpha = 0.6) +
  geom_point(aes(x=long, y = lat, size = Weight_lbs, color = Weight_lbs, text = mytext, alpha = 2)) +
  scale_size_continuous(range = c(1,10)) +
  theme_void() +
  coord_map() + 
  labs(title = "Connecting our Coastlines", subtitle = "Surfrider Foundation Massachusetts Chapter beach cleanup data ", color = "Weight (pounds)")
 


coc_map <- ggplotly(coc_map, tooltip = "text")

coc_map


```

```{r}

COC_long <- COC%>%
  pivot_longer(cols = c(starts_with("Cig"), starts_with("Plastic"), starts_with("Foam"), starts_with("Food"), starts_with("Ball"), starts_with("X6"), starts_with("Juice"), starts_with("Vape"), starts_with("Single"), starts_with("Bait"), starts_with("Buoy"), starts_with("Large"), starts_with("Fish"), starts_with("Hooks"), starts_with("Light"), starts_with("Net"), starts_with("Pots"), starts_with("Rope"), starts_with("Diaper"), starts_with("Syr"), starts_with("Tamp"), starts_with("Tooth"), starts_with("Bott"), starts_with("Shotg"), starts_with("Zip"), starts_with("Dog"), starts_with("Paper"), starts_with("Treated"), starts_with("Wood"), starts_with("Metal"), starts_with("Alum"), starts_with("Can"), starts_with("Glass"), starts_with("Cond"), starts_with("Tire"), starts_with("Fire"), starts_with("Tarp"), starts_with("Disin"), starts_with("Latex"), starts_with("Reus")),
               names_to = "Trash_Type", values_to = "Trash_Amount")

###sort data by type, create bar chart of total trash
```